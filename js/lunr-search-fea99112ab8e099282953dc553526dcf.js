var lunrIndex,$results,pagesIndex;var indexfile="/js/lunr.index.json";var min_chars=3;function initLunr(){$.getJSON(indexfile).done(function(index){pagesIndex=index;console.log("index:",pagesIndex);lunrIndex=lunr(function(){this.field("title",10);this.field("tags",5);this.field("content",1);this.ref("href");});pagesIndex.forEach(function(page){lunrIndex.add(page);});}).fail(function(jqxhr,textStatus,error){var err=textStatus+", "+error;console.error("Error getting Hugo index flie:",err);});}function initUI(){$results=$("#results");$("#search").keyup(function(){$results.empty();var query=$(this).val();if(query.length<min_chars)return;var results=search(query);renderResults(results);});}function search(query){return lunrIndex.search(query).map(function(result){return pagesIndex.filter(function(page){return page.href===result.ref;})[0];});}function renderResults(results){if(!results.length)return;results.slice(0,10).forEach(function(result){var $result=$("<li>");$result.append($("<a>",{href:result.href,text:">> "+result.title}));$results.append($result);});}initLunr();$(document).ready(function(){initUI();});